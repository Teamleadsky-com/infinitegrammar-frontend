# Environment Variables Setup Guide

## üìã Overview

This project uses environment variables to securely store database credentials and secrets. You need to configure these for both **local development** and **production (Netlify)**.

---

## üîß Local Development Setup

### Step 1: Get Your Neon Database Connection String

1. **Go to Netlify Dashboard:**
   - Navigate to: https://app.netlify.com
   - Select your site: `infinitegrammar`

2. **Access Neon Integration:**
   - Click on the **"Integrations"** tab
   - Find **"Neon Postgres"** in the list
   - Click **"Manage"** or **"Configure"**

3. **Get Connection String:**
   - Click **"View database details"** or look for **"Connection string"**
   - You'll see a string that looks like:
     ```
     postgresql://username:password@ep-xxxxx-xxxxx.us-east-2.aws.neon.tech/neondb?sslmode=require
     ```
   - Click to copy it

4. **Paste into .env file:**
   - Open the `.env` file in the project root
   - Replace the `DATABASE_URL` value with your connection string
   ```env
   DATABASE_URL=postgresql://your-actual-connection-string-here
   ```

### Step 2: Generate JWT Secret

Choose one of these methods to generate a secure random string:

**Option A - Using Terminal (Mac/Linux):**
```bash
openssl rand -base64 32
```

**Option B - Using Node.js:**
```bash
node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
```

**Option C - Online Generator:**
- Visit: https://generate-random.org/api-token-generator
- Generate a 32+ character token

**Paste into .env file:**
```env
JWT_SECRET=your-generated-random-string-here
```

### Step 3: Verify Your .env File

Your `.env` file should now look like this:

```env
DATABASE_URL=postgresql://neondb_owner:npg_xxxx@ep-xxxxx-xxxxx.us-east-2.aws.neon.tech/neondb?sslmode=require
JWT_SECRET=abc123randomstring456def789
NODE_ENV=development
```

‚úÖ **Done!** Your local environment is configured.

---

## üöÄ Production Setup (Netlify)

### Step 1: Access Environment Variables in Netlify

1. Go to: https://app.netlify.com
2. Select your site: `infinitegrammar`
3. Go to: **Site settings** ‚Üí **Environment variables**

### Step 2: Add DATABASE_URL

**The DATABASE_URL might already be set automatically by the Neon extension!**

Check if it exists:
- Look for a variable named `DATABASE_URL`
- If it exists, you're good! ‚úÖ
- If not, add it manually:

1. Click **"Add a variable"** ‚Üí **"Add a single variable"**
2. **Key:** `DATABASE_URL`
3. **Value:** (paste your Neon connection string)
4. **Scopes:** Select all (Builds, Functions, Post processing)
5. Click **"Create variable"**

### Step 3: Add JWT_SECRET

1. Click **"Add a variable"** ‚Üí **"Add a single variable"**
2. **Key:** `JWT_SECRET`
3. **Value:** (paste the same random string you used locally)
4. **Scopes:** Select **"Functions"** (most important)
5. Click **"Create variable"**

### Step 4: Add NODE_ENV (Optional)

1. Click **"Add a variable"** ‚Üí **"Add a single variable"**
2. **Key:** `NODE_ENV`
3. **Value:** `production`
4. **Scopes:** Select all
5. Click **"Create variable"**

‚úÖ **Done!** Your production environment is configured.

---

## üîç Troubleshooting

### "Cannot find DATABASE_URL"
- Make sure you've copied the connection string correctly
- Ensure there are no extra spaces or line breaks
- Connection string must start with `postgresql://`

### "DATABASE_URL not defined in Netlify Functions"
- Go to Site settings ‚Üí Environment variables
- Edit DATABASE_URL ‚Üí Make sure "Functions" scope is checked
- Redeploy your site

### "Connection refused" or "Database not found"
- Your Neon database might be in sleep mode
- Open Neon dashboard and wake it up
- Try connecting again in 10-20 seconds

### "Invalid JWT token"
- Make sure JWT_SECRET is the same in local .env and Netlify
- JWT_SECRET should be at least 32 characters long
- Use the same secret for both environments

---

## üìù Files in This Setup

- **`.env`** - Your local environment variables (DO NOT COMMIT!)
- **`.env.example`** - Template file (safe to commit)
- **`.env.setup.md`** - This guide (safe to commit)
- **`.gitignore`** - Configured to ignore `.env` files

---

## ‚ö†Ô∏è Security Notes

- ‚úÖ `.env` is in `.gitignore` - it won't be committed to Git
- ‚úÖ Never share your `.env` file or commit it to GitHub
- ‚úÖ Never post your DATABASE_URL or JWT_SECRET publicly
- ‚úÖ Rotate JWT_SECRET if you suspect it's been compromised

---

## üéØ Next Steps

Once environment variables are configured:

1. ‚úÖ Verify local .env file is filled in
2. ‚úÖ Verify Netlify environment variables are set
3. ‚û°Ô∏è Next: Create database tables (migrations)
4. ‚û°Ô∏è Next: Set up Netlify Functions
5. ‚û°Ô∏è Next: Connect frontend to backend

---

## üìû Need Help?

If you get stuck:
1. Check the Neon dashboard: https://console.neon.tech
2. Check Netlify integrations: Site ‚Üí Integrations ‚Üí Neon
3. Check Netlify build logs for any environment variable errors
